<!-- 成员授权编辑页面 -->
<extend name="Public/base" />

<block name="header">
    <include file="membermodal"/>
</block>

<!-- 子导航 -->
<block name="sidebar">
    <include file="Public/sidemenu"/>
</block>

<block name="content">
    <!-- 标题栏 -->
    <div class="ell-main-title">
        <h2>权限管理 [ 用户组：
            <select name="group">
                <volist name="auth_group" id="vo">
                <option value="{:U('AuthManager/access',array('group_id'=>$vo['id'],'group_name'=>$vo['title']))}" <eq name="vo['id']" value="$this_group['id']">selected</eq>>
                    {$vo.title}
                </option>
                </volist>
            </select>
        ]</h2>
    </div>

    <div class="ell-tab-wrap">
        <ul class="nav nav-tabs" role="tablist">
            <li><a href="{:U('AuthManager/access',array('group_name'=>I('group_name') ,'group_id'=> I('group_id')))}">访问授权</a></li>
            <li class="active"><a href="javascript:;">成员授权</a></li>
        </ul>

        <!-- 按钮工具栏 -->
        <div class="row">
            <div class="col-md-6">
                <div class="pull-left">
                    <button type="button" class="btn btn-success" data-toggle="modal" data-target="#myModal" data-get-param="group_id={$group_id}">添加成员</button>
                    <button type="button" class="btn btn-success ajax-post" data-target="[data-check='ids']" data-confirm="确认要删除吗?" data-url="">删除成员</button>
                </div>
            </div>
        </div>

        <!-- 数据列表 -->
        <div class="data-table">
            <table class="table table-condensed table-hover">
            <thead>
                <tr>
                    <th class="row-selected"><input type="checkbox" data-toggle="checkall" data-target="ids"/></th>
                    <th>UID</th>
                    <th>昵称</th>
                    <th>最后登录时间</th>
                    <th>最后登录IP</th>
                    <th>状态</th>
                    <th class="operator-xs-4"></th>
                </tr>
            </thead>
            <tbody>
                <volist name="_list" id="vo">
                <tr>
                    <td><input type="checkbox" data-check="ids" name="ids[]" value="{$vo.id}"></td>
                    <td>{$vo.id} </td>
                    <td>{$vo.username}</td>
                    <td>{$vo.last_login_time|time_format}</td>
                    <td>{$vo.last_login_ip|long2ip}</td>
                    <td>{$vo.status_text}</td>
                    <td>
                        <button type="button" class="btn btn-danger btn-xs operator ajax-get" data-confirm="确认要解除吗?" data-loading-text="执行中..." data-url="{:U('AuthManager/removeFromGroup?uid='.$vo['uid'].'&group_id='.I('group_id'))}" autocomplete="off">解除授权</button>
                    </td>
                </tr>
                </volist>
            </tbody>
            </table>
        </div>
        <div class="main-title">
            <div class="page_nav pull-left">
                {$_page}
            </div>
        </div>
    </div>
</block>

<block name="script">
<script type="text/javascript" charset="utf-8">
    $('select[name=group]').change(function(){
        location.href = this.value;
    });
</script>
</block>
