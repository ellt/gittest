<extend name="Public/base"/>

<block name="header">
    <include file="Addons://CustomMenu@CustomMenu/modal"/>
</block>

<block name="content">
    <!-- 标题栏 -->
    <div class="ell-main-title">
        <h2>自定义菜单</h2>
    </div>

    <!-- 按钮工具栏 -->
    <div class="row">
        <div class="col-md-6">
            <div class="pull-left">
                <button type="button" class="btn btn-success" <if condition="count_one_level_menu($list_data) egt 3">data-toggle="alert" data-alert-type="error" data-alert-info="一级菜单最多只能三个" <else/> data-toggle="modal" data-target="#myModal" data-get-param="id=0"</if> >新 增</button>
                <a class="btn btn-primary ajax-get" data-confirm="确认要发布吗?" data-url="{:U('send_menu?model='.$model['id'])}" data-loading-text="发布中..." autocomplete="off">发 布</a>
            </div>
        </div>
    </div>

    <!-- 数据表格 -->
    <div class="data-table">
        <table class="table table-condensed table-hover">
            <thead>
                <tr>
                    <th>菜单名</th>
                    <th>类型</th>
                    <th>关联关键词</th>
                    <th>关联URL</th>
                    <th>排序号</th>
                    <th class="operator-xs-4"></th>
                </tr>
            </thead>
            <tbody>
                <foreach name="list_data" item="vo">
                <tr>
                    <td>{$vo.title}</td>
                    <td>{:convert_menu_type($vo['type'])}</td>
                    <td>{$vo.keyword}</td>
                    <td>{$vo.url}</td>
                    <td>{$vo.sort}</td>
                    <td class="text-right">
                        <eq name="vo['type']" value="none">
                        <button type="button" class="btn btn-success btn-xs operator" <if condition="count_two_level_menu($list_data, $vo['id']) egt 5">data-toggle="alert" data-alert-type="error" data-alert-info="二级菜单最多只能五个" <else/> data-toggle="modal" data-target="#myModal" data-get-param="id={$vo.id}&method=sub"</if> >添加子菜单</button>
                        </eq>
                        <button type="button" class="btn btn-success btn-xs operator" data-toggle="modal" data-target="#myModal" data-get-param="id={$vo.id}&method=edit">编 辑</button>
                        <button class="btn btn-danger btn-xs operator ajax-get" data-confirm="确认要将该菜单下设置的消息删除吗?" data-url="{:U('del?id='.$vo['id'].'&model=custom_menu')}">删 除</button>
                    </td>
                </tr>
                </foreach>
            </tbody>
        </table>
    </div>
</block>